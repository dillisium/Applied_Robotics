{"version":3,"sources":["webpack:///./src/views/Slam.vue?61d0","webpack:///./node_modules/core-js/modules/es.math.sign.js","webpack:///./node_modules/core-js/modules/es.string.iterator.js","webpack:///./node_modules/core-js/modules/es.typed-array.float64-array.js","webpack:///./node_modules/core-js/internals/array-from.js","webpack:///./node_modules/core-js/modules/es.map.js","webpack:///./src/views/Slam.vue","webpack:///./src/components/SlamMap.vue","webpack:///../src/contextTracker.ts","webpack:///../src/index.ts","webpack:///./src/components/slam_map_decompress.ts","webpack:///./src/components/SlamMap.vue?95aa","webpack:///./src/components/SlamMap.vue?d4bb","webpack:///./src/views/Slam.vue?acdc","webpack:///./src/views/Slam.vue?8397","webpack:///./node_modules/core-js/internals/whitespaces.js","webpack:///./node_modules/core-js/internals/string-trim.js","webpack:///./src/components/SlamMap.vue?95fb","webpack:///./node_modules/core-js/internals/string-multibyte.js","webpack:///./node_modules/core-js/internals/collection-strong.js","webpack:///./node_modules/core-js/internals/collection.js","webpack:///./node_modules/core-js/modules/es.typed-array.uint8-clamped-array.js","webpack:///./node_modules/core-js/internals/call-with-safe-iteration-closing.js","webpack:///./node_modules/core-js/modules/es.array.from.js","webpack:///./node_modules/core-js/modules/es.number.constructor.js","webpack:///./node_modules/core-js/internals/freezing.js","webpack:///./node_modules/@babel/runtime/helpers/esm/createClass.js","webpack:///./node_modules/core-js/modules/es.typed-array.float32-array.js","webpack:///./node_modules/@babel/runtime/helpers/esm/classCallCheck.js","webpack:///./node_modules/core-js/modules/web.dom-collections.iterator.js","webpack:///./node_modules/core-js/internals/internal-metadata.js","webpack:///./node_modules/core-js/internals/math-sign.js","webpack:///./node_modules/core-js/modules/es.typed-array.uint32-array.js"],"names":["$","sign","target","stat","charAt","InternalStateModule","defineIterator","STRING_ITERATOR","setInternalState","set","getInternalState","getterFor","String","iterated","this","type","string","index","point","state","length","value","undefined","done","createTypedArrayConstructor","init","data","byteOffset","bind","toObject","callWithSafeIterationClosing","isArrayIteratorMethod","toLength","createProperty","getIteratorMethod","module","exports","arrayLike","result","step","iterator","next","O","C","Array","argumentsLength","arguments","mapfn","mapping","iteratorMethod","call","collection","collectionStrong","class","style","sendSLAMsh","handleFollowing","followingRobot","isPicking","i18n","$t","robotPosition","mqtt","slam","pos","targets","targetIndex","wsAddress","mapAddress","stickToRobot","handleTarget","sendAction","id","start","end","move","wheel","ctx","e","transformMatrix","a","height","canvasDisplayer","width","boundingClientRect","pixelRatio","canvasDecorator","ctxDisplayer","y","NBBY","MATCH_BITS","MATCH_MIN","OFFSET_MASK","decompress","sstart","slen","dstart","src","dst","cpy","copymap","copymask","mlen","offset","name","props","isOnePick","Boolean","Object","Number","setup","emit","slamCanvas","targetPointerEvent","startPickingTimeout","ws","reconnectIntervalId","timeframe","Date","getTime","pinchPointerMap","Map","pinchTimeStamp","altPressed","connectServer","close","console","log","WebSocket","binaryType","onmessage","m","byteLength","resolution","Float32Array","uint32Array","Uint32Array","float64Array","Float64Array","x","srcData","Uint8Array","desData","map","Uint8ClampedArray","buffer","i","updateMap","isValidPointer","evt","element","size","getBoundingClientRect","offsetX","offsetY","window","setTimeout","setPickingStart","navigator","vibrate","newPinchTime","clear","pointerId","Math","abs","clearTimeout","setPickingEnd","getPickingTarget","delete","keys","from","sort","has","cx","get","cy","dx","dy","updateTransform","fixedPointer","vector1","vector2","scale","sqrt","radian","deltaY","altListener","key","cancelPickingTarget","updateRobotPosition","updateTargets","updateTargetIndex","config","setConfig","moveToRobot","currentTargetColor","pickingTargetColor","gridSize","pastTargetColor","setInterval","now","addEventListener","clearInterval","removeEventListener","render","__scopeId","components","SlamMap","use","location","host","subscribe","qos","unsubscribe","floats","position","z","orientation","w","publish","action","sh","requireObjectCoercible","whitespaces","whitespace","ltrim","RegExp","rtrim","createMethod","TYPE","$this","replace","trim","toInteger","CONVERT_TO_STRING","first","second","S","charCodeAt","slice","codeAt","defineProperty","f","create","redefineAll","anInstance","iterate","setSpecies","DESCRIPTORS","fastKey","internalStateGetterFor","getConstructor","wrapper","CONSTRUCTOR_NAME","IS_MAP","ADDER","that","iterable","last","AS_ENTRIES","define","previous","entry","getEntry","removed","prototype","prev","forEach","callbackfn","boundFunction","add","setStrong","ITERATOR_NAME","getInternalCollectionState","getInternalIteratorState","kind","global","isForced","redefine","InternalMetadataModule","isObject","fails","checkCorrectnessOfIteration","setToStringTag","inheritIfRequired","common","indexOf","IS_WEAK","NativeConstructor","NativePrototype","Constructor","exported","fixMethod","KEY","nativeMethod","entries","REQUIRED","instance","HASNT_CHAINING","THROWS_ON_PRIMITIVES","ACCEPT_ITERABLES","BUGGY_ZERO","$instance","dummy","constructor","forced","anObject","iteratorClose","fn","ENTRIES","error","INCORRECT_ITERATION","classof","toPrimitive","getOwnPropertyNames","getOwnPropertyDescriptor","NUMBER","NativeNumber","NumberPrototype","BROKEN_CLASSOF","toNumber","argument","third","radix","maxCode","digits","code","it","NaN","parseInt","NumberWrapper","valueOf","split","j","isExtensible","preventExtensions","_defineProperties","descriptor","enumerable","configurable","writable","_createClass","protoProps","staticProps","_classCallCheck","TypeError","DOMIterables","ArrayIteratorMethods","createNonEnumerableProperty","wellKnownSymbol","ITERATOR","TO_STRING_TAG","ArrayValues","values","COLLECTION_NAME","Collection","CollectionPrototype","METHOD_NAME","hiddenKeys","uid","FREEZING","METADATA","setMetadata","objectID","weakData","getWeakData","onFreeze","meta"],"mappings":"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","file":"js/chunk-6c37cab8.166708c9.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./Slam.vue?vue&type=style&index=0&id=4b9c5e29&lang=scss&scoped=true\"","var $ = require('../internals/export');\nvar sign = require('../internals/math-sign');\n\n// `Math.sign` method\n// https://tc39.github.io/ecma262/#sec-math.sign\n$({ target: 'Math', stat: true }, {\n  sign: sign\n});\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.github.io/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: String(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.github.io/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float64Array` constructor\n// https://tc39.github.io/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float64', function (init) {\n  return function Float64Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","'use strict';\nvar bind = require('../internals/function-bind-context');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\n// `Array.from` method implementation\n// https://tc39.github.io/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var C = typeof this == 'function' ? this : Array;\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined, 2);\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod != undefined && !(C == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = iteratorMethod.call(O);\n    next = iterator.next;\n    result = new C();\n    for (;!(step = next.call(iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = toLength(O.length);\n    result = new C(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","'use strict';\nvar collection = require('../internals/collection');\nvar collectionStrong = require('../internals/collection-strong');\n\n// `Map` constructor\n// https://tc39.github.io/ecma262/#sec-map-objects\nmodule.exports = collection('Map', function (init) {\n  return function Map() { return init(this, arguments.length ? arguments[0] : undefined); };\n}, collectionStrong);\n","<template>\n  <div class=\"u-content\">\n    <h2>\n      <i class=\"fa fa-map\"></i> | Slam\n      <span class=\"top-buttons\" style=\"float: right; color: black;\">\n        <span @click=\"sendSLAMsh('stop')\"\n          ><i class=\"fa fa-stop\" style=\"color: red;\"></i> </span\n        >&nbsp;|&nbsp;\n        <span @click=\"sendSLAMsh('restart')\"\n          ><i class=\"fa fa-play\" style=\"color: green;\"></i\n        ></span>\n        <span @click=\"sendSLAMsh('clear')\"\n          ><i class=\"fa fa-history\" style=\"color: darkorange;\"></i\n        ></span>\n        &nbsp;|&nbsp;\n        <span\n          @click=\"handleFollowing\"\n          :style=\"followingRobot ? 'color: blue;' : ''\"\n          ><i class=\"fa fa-crosshairs\"></i></span\n        >&nbsp;|&nbsp;\n        <span class=\"pick-button\" @click=\"isPicking = !isPicking\">\n          <span v-if=\"!isPicking\">\n            <i class=\"fas fa-map-pin\"></i>\n            {{ i18n.$t(\"PickTarget\") }}\n          </span>\n          <span v-else>\n            <i class=\"fas fa-times\"></i>\n            {{ i18n.$t(\"PickTarget\") }}\n          </span>\n        </span>\n      </span>\n    </h2>\n    <slam-map\n      class=\"slam-map\"\n      :isPicking=\"isPicking\"\n      :robotPosition=\"mqtt.data.slam.pos\"\n      :targets=\"mqtt.data.slam.targets\"\n      :targetIndex=\"mqtt.data.slam.targetIndex\"\n      :wsAddress=\"'ws://' + mapAddress + '/map'\"\n      :stickToRobot=\"followingRobot\"\n      @update=\"handleTarget\"\n    ></slam-map>\n    <div class=\"map-buttons\">\n      <div class=\"map-button\" @click=\"sendAction('loop')\">\n        <i class=\"fa fa-retweet\"></i>\n      </div>\n      <div class=\"map-button\" @click=\"sendAction('remove_one')\">-1</div>\n      <div class=\"map-button\" @click=\"sendAction('remove_all')\">\n        <i class=\"fa fa-trash\"></i>\n      </div>\n      <div class=\"map-button\" @click=\"sendAction('move_one')\">\n        <i class=\"fa fa-play\"></i>\n      </div>\n      <div class=\"map-button\" @click=\"sendAction('pause')\">\n        <i class=\"fa fa-pause\"></i>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, ref, onMounted, Ref, onBeforeUnmount } from \"vue\";\nimport SlamMap from \"@/components/SlamMap.vue\";\nimport { Target } from \"slam2D\";\nimport MqttPlugin from \"@/plugins/mqttPlugin\";\nimport I18nPlugin from \"@/plugins/i18nPlugin\";\nexport default defineComponent({\n  name: \"Slam\",\n  components: {\n    SlamMap\n  },\n  setup() {\n    const i18n = I18nPlugin.use();\n    const mqtt = MqttPlugin.use();\n    const isPicking = ref(false);\n    const robotPosition: Ref<Target | null> = ref(null);\n    const followingRobot = ref(false);\n    const mapAddress = ref(\n      process.env.NODE_ENV == \"development\"\n        ? process.env.VUE_APP_DEVICE_ADDRESS\n        : window.location.host\n    );\n\n    onMounted(() => {\n      setTimeout(() => {\n        mqtt.subscribe(\"slam/position\", { qos: 0 });\n        mqtt.subscribe([\"slam/targets\", \"slam/target_index\", \"slam/looping\"], {\n          qos: 1\n        });\n      }, 1000);\n    });\n\n    onBeforeUnmount(() => {\n      mqtt.unsubscribe([\n        \"slam/position\",\n        \"slam/targets\",\n        \"slam/target_index\",\n        \"slam/looping\"\n      ]);\n    });\n    const handleTarget = (target: Target) => {\n      const floats = new Float64Array(7);\n      floats[0] = target.position.x;\n      floats[1] = target.position.y;\n      floats[2] = target.position.z;\n      floats[3] = target.orientation.x;\n      floats[4] = target.orientation.y;\n      floats[5] = target.orientation.z;\n      floats[6] = target.orientation.w;\n      mqtt.publish(\"slam/new_target\", floats.buffer, { qos: 0 });\n    };\n    const handleFollowing = () => {\n      followingRobot.value = !followingRobot.value;\n      if (isPicking.value && followingRobot.value) {\n        setTimeout(() => {\n          followingRobot.value = false;\n        }, 500);\n      }\n    };\n    const sendAction = (action: string) => {\n      mqtt.publish(\"slam/action\", action, { qos: 1 });\n    };\n    const sendSLAMsh = (sh: string) => {\n      mqtt.publish(\"slam/manager\", sh, { qos: 1 });\n    };\n    return {\n      isPicking,\n      robotPosition,\n      mqtt,\n      handleTarget,\n      handleFollowing,\n      sendAction,\n      sendSLAMsh,\n      followingRobot,\n      i18n,\n      mapAddress\n    };\n  }\n});\n</script>\n\n<style lang=\"scss\" scoped>\n.slam-map {\n  height: calc(100vh - 64px);\n  position: relative;\n}\n.top-buttons {\n  & > span {\n    &.pick-button {\n      width: 100px;\n    }\n    padding: 10px;\n  }\n  i {\n    font-size: large;\n  }\n}\n.map-buttons {\n  position: absolute;\n  top: 70px;\n  right: 20px;\n  display: flex;\n  flex-direction: column;\n  .map-button {\n    margin-top: 20px;\n    font-size: large;\n    width: 40px;\n    height: 40px;\n    padding-top: 6px;\n    text-align: center;\n    color: white;\n    border-radius: 50%;\n    background-color: rgba($color: #000000, $alpha: 0.5);\n    backdrop-filter: blur(2px);\n    &:hover {\n      background-color: rgba($color: #333300, $alpha: 0.6);\n    }\n  }\n}\n</style>\n","<template>\n  <div>\n    <canvas id=\"slamDisplayer\"></canvas>\n    <canvas\n      id=\"slamDecorator\"\n      @pointerdown=\"start\"\n      @pointerup=\"end\"\n      @pointercancel=\"end\"\n      @pointermove=\"move\"\n      @mousewheel=\"wheel\"\n    ></canvas>\n  </div>\n</template>\n\n<script lang=\"ts\">\n/* eslint-disable */\nimport {\n  defineComponent,\n  onMounted,\n  watchEffect,\n  PropType,\n  resolveDynamicComponent,\n  onBeforeUnmount,\n  ref,\n  Ref\n} from \"vue\";\nimport { SlamCanvas, Target } from \"slam2D\";\nimport decompress from \"./slam_map_decompress\";\n\nexport default defineComponent({\n  name: \"Slam\",\n  props: {\n    isOnePick: Boolean,\n    isPicking: Boolean,\n    stickToRobot: Boolean,\n    robotPosition: Object as PropType<Target>,\n    wsAddress: String,\n    targets: Object as PropType<Target[]>,\n    targetIndex: Number\n  },\n  setup(props, { emit }) {\n    let slamCanvas: null | SlamCanvas = null;\n    let targetPointerEvent: null | PointerEvent = null;\n    let startPickingTimeout: null | number = null;\n    let ws: null | WebSocket = null;\n    let reconnectIntervalId: number = 0;\n    let timeframe = new Date().getTime();\n    const pinchPointerMap: Map<number, PointerEvent> = new Map();\n    let pinchTimeStamp: number = new Date().getTime();\n    let altPressed = false;\n\n    const connectServer = () => {\n      if (!props.wsAddress) return;\n      if (ws) ws.close();\n      console.log(props.wsAddress);\n      ws = new WebSocket(props.wsAddress);\n      ws.binaryType = \"arraybuffer\";\n      ws.onmessage = m => {\n        timeframe = new Date().getTime();\n        if (m.data.byteLength > 80) {\n          const resolution = new Float32Array(m.data, 8, 1)[0];\n          const uint32Array = new Uint32Array(m.data, 12, 2);\n          const width = uint32Array[0];\n          const height = uint32Array[1];\n          const float64Array = new Float64Array(m.data, 24, 7);\n          const x = float64Array[0];\n          const y = float64Array[1];\n          const srcData = new Uint8Array(m.data, 80);\n          const desData = new Uint8Array(width * height);\n          decompress(srcData, srcData.length, desData);\n          const map = new Uint32Array(\n            new Uint8ClampedArray(desData.length * 4).buffer\n          );\n          for (let i = 0; i < desData.length; i++) {\n            if (desData[i] === 200) {\n              map[i] = 0xff99bbbb;\n            } else if (desData[i] === 255) {\n              map[i] = 0xffdddddd;\n            } else if (desData[i] === 0) {\n              map[i] = 0xff000000;\n            } else {\n              map[i] = 0xffdddd00;\n            }\n          }\n          slamCanvas?.updateMap(map.buffer, width, height, resolution, x, y);\n        }\n      };\n    };\n\n    const isValidPointer = (evt: PointerEvent) => {\n      const element = evt.target as HTMLCanvasElement;\n      const size = element.getBoundingClientRect();\n      return (\n        evt.offsetX > 0 &&\n        evt.offsetX < size.width &&\n        evt.offsetY > 0 &&\n        evt.offsetY < size.height\n      );\n    };\n    const start = (evt: PointerEvent) => {\n      if (!isValidPointer(evt)) return;\n      if (!targetPointerEvent && props.isPicking) {\n        targetPointerEvent = evt;\n        startPickingTimeout = window.setTimeout(() => {\n          if (props.isPicking)\n            slamCanvas?.setPickingStart(evt.offsetX, evt.offsetY);\n          if (navigator.vibrate) {\n            navigator.vibrate(150);\n          }\n        }, 300);\n      }\n      if (!props.isPicking) {\n        const newPinchTime = new Date().getTime();\n        if (newPinchTime - pinchTimeStamp > 2000) {\n          pinchPointerMap.clear();\n          pinchTimeStamp = newPinchTime;\n        }\n        pinchPointerMap.set(evt.pointerId, evt);\n      }\n    };\n    const move = (evt: PointerEvent) => {\n      if (targetPointerEvent?.pointerId === evt.pointerId && props.isPicking) {\n        if (\n          Math.abs(targetPointerEvent.offsetX - evt.offsetX) +\n            Math.abs(targetPointerEvent.offsetY - evt.offsetY) >\n          10\n        ) {\n          if (startPickingTimeout) clearTimeout(startPickingTimeout);\n        }\n        slamCanvas?.setPickingEnd(evt.offsetX, evt.offsetY);\n        if (!isValidPointer(evt)) {\n          const target = slamCanvas?.getPickingTarget();\n          if (target) emit(\"update\", target);\n          targetPointerEvent = null;\n        }\n      }\n      if (!props.isPicking) {\n        const newPinchTime = new Date().getTime();\n        if (!isValidPointer(evt)) {\n          pinchPointerMap.delete(evt.pointerId);\n          pinchTimeStamp = newPinchTime;\n          return;\n        }\n        const keys = Array.from(pinchPointerMap.keys()).sort();\n        if (\n          keys.length === 1 &&\n          keys[0] === evt.pointerId &&\n          pinchPointerMap.has(evt.pointerId)\n        ) {\n          const cx = pinchPointerMap.get(evt.pointerId)!.offsetX;\n          const cy = pinchPointerMap.get(evt.pointerId)!.offsetY;\n          const dx = evt.offsetX - cx;\n          const dy = evt.offsetY - cy;\n          slamCanvas?.updateTransform(cx, cy, 0, 1, dx, dy);\n          pinchPointerMap.set(evt.pointerId, evt);\n          pinchTimeStamp = newPinchTime;\n        }\n        if (\n          keys.length > 1 &&\n          (evt.pointerId === keys[0] || evt.pointerId === keys[1])\n        ) {\n          const cx =\n            (pinchPointerMap.get(keys[0])!.offsetX +\n              pinchPointerMap.get(keys[1])!.offsetX) /\n            2;\n          const cy =\n            (pinchPointerMap.get(keys[0])!.offsetY +\n              pinchPointerMap.get(keys[1])!.offsetY) /\n            2;\n          const dx =\n            (evt.offsetX - pinchPointerMap.get(evt.pointerId)!.offsetX) / 2;\n          const dy =\n            (evt.offsetY - pinchPointerMap.get(evt.pointerId)!.offsetY) / 2;\n          const fixedPointer =\n            evt.pointerId === keys[0]\n              ? pinchPointerMap.get(keys[1])\n              : pinchPointerMap.get(keys[0]);\n          const vector1 = {\n            x:\n              pinchPointerMap.get(evt.pointerId)!.offsetX -\n              fixedPointer!.offsetX,\n            y:\n              pinchPointerMap.get(evt.pointerId)!.offsetY -\n              fixedPointer!.offsetY\n          };\n          const vector2 = {\n            x: evt.offsetX - fixedPointer!.offsetX,\n            y: evt.offsetY - fixedPointer!.offsetY\n          };\n          const scale = Math.sqrt(\n            (vector2.x ** 2 + vector2.y ** 2) /\n              (vector1.x ** 2 + vector1.y ** 2)\n          );\n          const radian =\n            (vector1.x * vector2.y - vector2.x * vector1.y) /\n            (vector1.x ** 2 + vector1.y ** 2);\n          slamCanvas?.updateTransform(cx, cy, radian, scale, dx, dy);\n          pinchPointerMap.set(evt.pointerId, evt);\n          pinchTimeStamp = newPinchTime;\n        }\n      }\n    };\n    const end = (evt: PointerEvent) => {\n      if (targetPointerEvent?.pointerId === evt.pointerId && props.isPicking) {\n        if (startPickingTimeout) clearTimeout(startPickingTimeout);\n        slamCanvas?.setPickingEnd(evt.offsetX, evt.offsetY);\n        const target = slamCanvas?.getPickingTarget();\n        if (target) {\n          emit(\"update\", target);\n        }\n      }\n      targetPointerEvent = null;\n      pinchPointerMap.delete(evt.pointerId);\n      pinchTimeStamp = new Date().getTime();\n    };\n\n    const wheel = (evt: MouseWheelEvent) => {\n      if (!props.isPicking) {\n        if (!altPressed) {\n          slamCanvas?.updateTransform(\n            evt.offsetX,\n            evt.offsetY,\n            0,\n            1.001 ** evt.deltaY,\n            0,\n            0\n          );\n        } else {\n          slamCanvas?.updateTransform(\n            evt.offsetX,\n            evt.offsetY,\n            evt.deltaY/1000,\n            1,\n            0,\n            0\n          );\n        }\n      }\n    };\n\n    const altListener = (evt: KeyboardEvent) => {\n      if (evt.key === \"Alt\") {\n        if (evt.type === \"keydown\") altPressed = true;\n        if (evt.type === \"keyup\") altPressed = false;\n      }\n    };\n\n    watchEffect(() => {\n      if (!props.isPicking) {\n        slamCanvas?.cancelPickingTarget();\n        targetPointerEvent = null;\n      }\n      pinchPointerMap.clear();\n    });\n\n    //..................\n    watchEffect(() => {\n      if (props.robotPosition) {\n        slamCanvas?.updateRobotPosition(props.robotPosition);\n      }\n    });\n    watchEffect(() => {\n      if (props.targets) {\n        slamCanvas?.updateTargets(props.targets);\n      }\n    });\n    watchEffect(() => {\n      if (props.targetIndex !== undefined) {\n        slamCanvas?.updateTargetIndex(props.targetIndex);\n      }\n    });\n    watchEffect(() => {\n      const config = { stickToRobot: props.stickToRobot && !props.isPicking };\n      slamCanvas?.setConfig(config);\n      if (props.isPicking && props.stickToRobot) {\n        slamCanvas?.moveToRobot();\n      }\n    });\n\n    //...............\n\n    onMounted(() => {\n      slamCanvas = new SlamCanvas(\"slamDisplayer\", \"slamDecorator\");\n      slamCanvas.setConfig({\n        currentTargetColor:\"orange\",\n        pickingTargetColor: \"blue\",\n        gridSize: 1,\n        pastTargetColor: \"red\"\n      });\n      connectServer();\n      reconnectIntervalId = window.setInterval(() => {\n        const now = new Date().getTime();\n        if (now - timeframe > 5000) {\n          timeframe = now;\n          connectServer();\n        }\n      }, 500);\n      window.addEventListener(\"keydown\", altListener);\n      window.addEventListener(\"keyup\", altListener);\n    });\n    onBeforeUnmount(() => {\n      if (ws) ws.close();\n      window.clearInterval(reconnectIntervalId);\n      window.removeEventListener(\"keydown\", altListener);\n      window.removeEventListener(\"keyup\", altListener);\n    });\n    return { start, move, end, wheel };\n  }\n});\n</script>\n\n<style lang=\"scss\" scoped>\ncanvas {\n  height: 100%;\n  padding: 0;\n  margin: 0;\n  line-height: 0;\n  width: 100%;\n  position: absolute;\n}\n#slamDisplayer {\n  background-color: whitesmoke;\n}\n#slamDecorator {\n  background-color: transparent;\n}\n</style>\n","export function ctxTracker(context) {\n    const ctx = context;\n    let transformMatrix = new DOMMatrix().translate(0, 0);\n    let savedTransforms = [];\n    ctx.reset = () => { transformMatrix = new DOMMatrix().translate(0, 0); savedTransforms = []; };\n    ctx.getTransform = () => transformMatrix;\n    const save = ctx.save;\n    ctx.save = () => {\n        savedTransforms.push(transformMatrix.translate(0, 0));\n        return save.call(ctx);\n    };\n    const restore = ctx.restore;\n    ctx.restore = () => {\n        transformMatrix = savedTransforms.pop();\n        return restore.call(ctx);\n    };\n    const scale = ctx.scale;\n    ctx.scale = (sx, sy) => {\n        transformMatrix = transformMatrix.scale(sx, sy);\n        return scale.call(ctx, sx, sy);\n    };\n    const rotate = ctx.rotate;\n    ctx.rotate = (radians) => {\n        transformMatrix = transformMatrix.rotate((radians * 180) / Math.PI);\n        return rotate.call(ctx, radians);\n    };\n    const translate = ctx.translate;\n    ctx.translate = (dx, dy) => {\n        transformMatrix = transformMatrix.translate(dx, dy);\n        return translate.call(ctx, dx, dy);\n    };\n    const transform = ctx.transform;\n    ctx.transform = (a, b, c, d, e, f) => {\n        const m2 = new DOMMatrix();\n        m2.a = a;\n        m2.b = b;\n        m2.c = c;\n        m2.d = d;\n        m2.e = e;\n        m2.f = f;\n        transformMatrix = transformMatrix.multiply(m2);\n        return transform.call(ctx, a, b, c, d, e, f);\n    };\n    const setTransform = ctx.setTransform;\n    ctx.setTransform = (a, b, c, d, e, f) => {\n        if (typeof a === 'number') {\n            transformMatrix.a = a;\n            transformMatrix.b = b;\n            transformMatrix.c = c;\n            transformMatrix.d = d;\n            transformMatrix.e = e;\n            transformMatrix.f = f;\n            return setTransform.call(ctx, a, b, c, d, e, f);\n        }\n        else {\n            transformMatrix.a = a.a;\n            transformMatrix.b = a.b;\n            transformMatrix.c = a.c;\n            transformMatrix.d = a.d;\n            transformMatrix.e = a.e;\n            transformMatrix.f = a.f;\n            return setTransform.call(ctx, a);\n        }\n    };\n    const sp = new DOMPoint();\n    ctx.screenToPixel = function (x, y) {\n        sp.x = x;\n        sp.y = y;\n        return sp.matrixTransform(transformMatrix.inverse());\n    };\n    const ps = new DOMPoint();\n    ctx.pixelToScreen = function (x, y) {\n        ps.x = x;\n        ps.y = y;\n        return ps.matrixTransform(transformMatrix);\n    };\n    ctx.getCurrentScale = function () {\n        return {\n            x: Math.sqrt(transformMatrix.a * transformMatrix.a + transformMatrix.b * transformMatrix.b),\n            y: Math.sqrt(transformMatrix.c * transformMatrix.c + transformMatrix.d * transformMatrix.d),\n        };\n    };\n    ctx.getAngle = function () {\n        return Math.atan2(transformMatrix.b, transformMatrix.a);\n    };\n}\n//# sourceMappingURL=contextTracker.js.map","import { ctxTracker } from \"./contextTracker\";\n;\nexport class SlamCanvas {\n    constructor(displayerId, decoratorId) {\n        this.canvasDisplayer = document.getElementById(displayerId);\n        const ctxDisplayer = this.canvasDisplayer.getContext('2d');\n        ctxTracker(ctxDisplayer);\n        this.ctxDisplayer = ctxDisplayer;\n        this.canvasDecorator = document.getElementById(decoratorId);\n        this.canvasDecorator.style.touchAction = \"none\";\n        this.ctxDecorator = this.canvasDecorator.getContext('2d');\n        this.canvasReceiver = document.createElement('canvas');\n        this.ctxReceiver = this.canvasReceiver.getContext('2d');\n        this.canvasGridCopy = document.createElement('canvas');\n        this.ctxGridCopy = this.canvasGridCopy.getContext('2d');\n        window.addEventListener('resize', this.resize.bind(this));\n        this.pixelRatio = window.devicePixelRatio;\n        const boundingClientRect = this.canvasDisplayer.getBoundingClientRect();\n        this.canvasDisplayer.height = boundingClientRect.height * this.pixelRatio;\n        this.canvasDecorator.height = this.canvasDisplayer.height;\n        this.canvasDisplayer.width = boundingClientRect.width * this.pixelRatio;\n        this.canvasDecorator.width = this.canvasDisplayer.width;\n        this.ctxDisplayer.translate(this.canvasDisplayer.width / 2, this.canvasDisplayer.height / 2);\n        this.ctxDisplayer.scale(this.pixelRatio, this.pixelRatio);\n        this.ctxDisplayer.rotate(-Math.PI / 2);\n        this.mapData = null;\n        this.mapDataOrigin = null;\n        this.pickingTarget = null;\n        this.targetList = [];\n        this.targetIndex = 0;\n        this.hasObjects = false;\n        this.robotPosition = null;\n        this.defaultConfig();\n        this.defaultFakeMap();\n    }\n    defaultConfig() {\n        this.scaleLimits = { upper: 3, lower: 0.3 };\n        this.gridSize = 1;\n        this.pickingTargetColor = \"green\";\n        this.pastTargetColor = \"red\";\n        this.currentTargetColor = \"yellow\";\n        this.futureTargetColor = \"green\";\n        this.robotColor = \"red\";\n        this.gridColor = \"black\";\n        this.stickToRobot = false;\n    }\n    defaultFakeMap() {\n        this.canvasReceiver.width = 200;\n        this.canvasReceiver.height = 200;\n        const fakeData = new Uint8ClampedArray(200 * 200 * 4);\n        const fakeData32 = new Uint32Array(fakeData.buffer);\n        for (let i = 0; i < fakeData32.length; i++) {\n            fakeData32[i] = 0xff99bbbb;\n        }\n        this.mapData = new ImageData(fakeData, 200);\n        this.ctxReceiver.putImageData(this.mapData, 0, 0);\n        this.mapDataOrigin = { x: -100, y: -100 };\n        this.resolution = 0.05;\n        this.drawMap();\n        this.drawGrids();\n    }\n    setConfig(config) {\n        if (config.gridSize)\n            this.gridSize = config.gridSize;\n        if (config.scaleLimits)\n            this.scaleLimits = config.scaleLimits;\n        if (config.pickingTargetColor)\n            this.pickingTargetColor = config.pickingTargetColor;\n        if (config.pastTargetColor)\n            this.pastTargetColor = config.pastTargetColor;\n        if (config.currentTargetColor)\n            this.currentTargetColor = config.currentTargetColor;\n        if (config.futureTargetColor)\n            this.futureTargetColor = config.futureTargetColor;\n        if (config.gridColor)\n            this.gridColor = config.gridColor;\n        if (config.stickToRobot !== undefined)\n            this.stickToRobot = config.stickToRobot;\n        if (config.robotColor)\n            this.robotColor = config.robotColor;\n    }\n    garbageCollect() {\n        window.removeEventListener('resize', this.resize);\n    }\n    resize() {\n        const mx = this.ctxDisplayer.getTransform();\n        const boundingClientRect = this.canvasDisplayer.getBoundingClientRect();\n        this.canvasDisplayer.height = boundingClientRect.height * this.pixelRatio;\n        this.canvasDisplayer.width = boundingClientRect.width * this.pixelRatio;\n        this.canvasDecorator.height = this.canvasDisplayer.height;\n        this.canvasDecorator.width = this.canvasDisplayer.width;\n        this.ctxDisplayer.reset();\n        this.ctxDisplayer.setTransform(mx.a, mx.b, mx.c, mx.d, mx.e, mx.f);\n        this.drawMap();\n        this.drawGrids();\n        this.drawObjects();\n    }\n    reset() {\n        this.pixelRatio = window.devicePixelRatio;\n        const boundingClientRect = this.canvasDisplayer.getBoundingClientRect();\n        this.canvasDisplayer.height = boundingClientRect.height * this.pixelRatio;\n        this.canvasDisplayer.width = boundingClientRect.width * this.pixelRatio;\n        this.canvasDecorator.height = this.canvasDisplayer.height;\n        this.canvasDecorator.width = this.canvasDisplayer.width;\n        this.ctxDisplayer.reset();\n        this.ctxDisplayer.translate(this.canvasDisplayer.width / 2, this.canvasDisplayer.height / 2);\n        this.ctxDisplayer.scale(this.pixelRatio, this.pixelRatio);\n        this.drawMap();\n        this.drawGrids();\n        this.drawObjects();\n    }\n    updateTransform(cx, cy, radian, scale, dx, dy) {\n        this.pickingTarget = null;\n        const transformCenter = this.ctxDisplayer.screenToPixel(cx * this.pixelRatio, cy * this.pixelRatio);\n        const transformTo = this.ctxDisplayer.screenToPixel(dx * this.pixelRatio, dy * this.pixelRatio);\n        const transformFrom = this.ctxDisplayer.screenToPixel(0, 0);\n        const transform = new DOMPoint(transformTo.x - transformFrom.x, transformTo.y - transformFrom.y);\n        this.ctxDisplayer.translate(transformCenter.x, transformCenter.y);\n        this.ctxDisplayer.rotate(radian);\n        const currentScale = this.ctxDisplayer.getCurrentScale().x / this.pixelRatio;\n        const scaleExpected = currentScale * scale;\n        const scaleLimited = scale > 1 ? (scaleExpected >= this.scaleLimits.upper ? this.scaleLimits.upper / currentScale : scale) :\n            (scaleExpected <= this.scaleLimits.lower ? this.scaleLimits.lower / currentScale : scale);\n        this.ctxDisplayer.scale(scaleLimited, scaleLimited);\n        this.ctxDisplayer.translate(-transformCenter.x, -transformCenter.y);\n        this.ctxDisplayer.translate(transform.x, transform.y);\n        this.drawMap();\n        this.drawGrids();\n        this.drawObjects();\n    }\n    updateMap(mapBuffer, mapWidth, mapHeight, resolution, originX, originY) {\n        this.canvasReceiver.width = mapWidth;\n        this.canvasReceiver.height = mapHeight;\n        this.mapData = new ImageData(new Uint8ClampedArray(mapBuffer), mapWidth);\n        this.ctxReceiver.putImageData(this.mapData, 0, 0);\n        this.mapDataOrigin = { x: originX / resolution, y: -mapHeight - originY / resolution };\n        this.resolution = resolution;\n        this.drawMap();\n        this.drawGrids();\n        this.drawObjects();\n    }\n    moveToRobot(filterAngle) {\n        const robotOnMap = { x: this.robotPosition.position.x / this.resolution, y: -this.robotPosition.position.y / this.resolution };\n        const centerOnMap = this.ctxDisplayer.screenToPixel(this.canvasDisplayer.width / 2, this.canvasDisplayer.height / 2);\n        this.ctxDisplayer.translate(centerOnMap.x - robotOnMap.x, centerOnMap.y - robotOnMap.y);\n        const mapAngle = this.ctxDisplayer.getAngle();\n        let angle = (Math.asin(this.robotPosition.orientation.z) * 2 - mapAngle - Math.PI / 2) % (Math.PI * 2);\n        angle = Math.abs(angle) > Math.PI ? angle - 2 * Math.sign(angle) * Math.PI : angle;\n        if (filterAngle)\n            this.ctxDisplayer.rotate(Math.abs(angle) > 0.5 ? angle / 10 : angle / 50);\n        else\n            this.ctxDisplayer.rotate(angle);\n        this.drawMap();\n        this.drawGrids();\n        this.drawObjects();\n    }\n    updateRobotPosition(position) {\n        this.robotPosition = position;\n        if (this.stickToRobot) {\n            this.moveToRobot(true);\n        }\n        else {\n            this.drawObjects();\n        }\n    }\n    updateTargets(targets) {\n        this.targetList = targets;\n        this.drawObjects();\n    }\n    updateTargetIndex(index) {\n        this.targetIndex = index;\n        this.drawObjects();\n    }\n    drawMap() {\n        this.ctxDisplayer.save();\n        this.ctxDisplayer.setTransform(1, 0, 0, 1, 0, 0);\n        this.ctxDisplayer.clearRect(0, 0, this.canvasDisplayer.width, this.canvasDisplayer.height);\n        this.ctxDisplayer.restore();\n        this.ctxDisplayer.drawImage(this.canvasReceiver, this.mapDataOrigin.x, this.mapDataOrigin.y);\n    }\n    drawGrids() {\n        this.ctxDecorator.clearRect(0, 0, this.canvasDecorator.width, this.canvasDecorator.height);\n        this.ctxDecorator.fillStyle = this.gridColor;\n        this.ctxDecorator.strokeStyle = this.gridColor;\n        this.ctxDecorator.lineWidth = 1;\n        const lt = this.ctxDisplayer.screenToPixel(0, 0);\n        const lb = this.ctxDisplayer.screenToPixel(0, this.canvasDecorator.height);\n        const rt = this.ctxDisplayer.screenToPixel(this.canvasDecorator.width, 0);\n        const rb = this.ctxDisplayer.screenToPixel(this.canvasDecorator.width, this.canvasDecorator.height);\n        const xMax = Math.max(lt.x, lb.x, rt.x, rb.x);\n        const xMin = Math.min(lt.x, lb.x, rt.x, rb.x);\n        const yMax = Math.max(lt.y, lb.y, rt.y, rb.y);\n        const yMin = Math.min(lt.y, lb.y, rt.y, rb.y);\n        const gridOrigin = this.ctxDisplayer.pixelToScreen(0, 0);\n        this.ctxDecorator.beginPath();\n        this.ctxDecorator.arc(gridOrigin.x, gridOrigin.y, 3 * this.pixelRatio, 0, Math.PI * 2, true);\n        this.ctxDecorator.fill();\n        const gridStep = this.gridSize / this.resolution;\n        const gridStep0 = this.ctxDisplayer.screenToPixel(0, 0);\n        const xGridStep = this.ctxDisplayer.pixelToScreen(gridStep0.x + gridStep, gridStep0.y);\n        const xGridStart0 = this.ctxDisplayer.pixelToScreen(0, yMin);\n        const xGridEnd0 = this.ctxDisplayer.pixelToScreen(0, yMax);\n        for (let i = Math.ceil(xMin / gridStep); i < Math.ceil(xMax / gridStep); i++) {\n            this.ctxDecorator.beginPath();\n            this.ctxDecorator.moveTo(xGridStart0.x + xGridStep.x * i, xGridStart0.y + xGridStep.y * i);\n            this.ctxDecorator.lineTo(xGridEnd0.x + xGridStep.x * i, xGridEnd0.y + xGridStep.y * i);\n            this.ctxDecorator.stroke();\n        }\n        const yGridStep = this.ctxDisplayer.pixelToScreen(gridStep0.x, gridStep0.y + gridStep);\n        const yGridStart0 = this.ctxDisplayer.pixelToScreen(xMin, 0);\n        const yGridEnd0 = this.ctxDisplayer.pixelToScreen(xMax, 0);\n        for (let i = Math.ceil(yMin / gridStep); i < Math.ceil(yMax / gridStep); i++) {\n            this.ctxDecorator.beginPath();\n            this.ctxDecorator.moveTo(yGridStart0.x + yGridStep.x * i, yGridStart0.y + yGridStep.y * i);\n            this.ctxDecorator.lineTo(yGridEnd0.x + yGridStep.x * i, yGridEnd0.y + yGridStep.y * i);\n            this.ctxDecorator.stroke();\n        }\n        this.hasObjects = false;\n        this.canvasGridCopy.width = this.canvasDecorator.width;\n        this.canvasGridCopy.height = this.canvasDecorator.height;\n        this.ctxGridCopy.drawImage(this.canvasDecorator, 0, 0);\n    }\n    setPickingStart(x, y) {\n        const sx = x * this.pixelRatio;\n        const sy = y * this.pixelRatio;\n        this.pickingTarget = { sx: sx, sy: sy, ex: sx, ey: sy };\n    }\n    setPickingEnd(x, y) {\n        if (this.pickingTarget) {\n            this.pickingTarget.ex = x * this.pixelRatio;\n            this.pickingTarget.ey = y * this.pixelRatio;\n            this.drawObjects();\n        }\n    }\n    cancelPickingTarget() {\n        this.pickingTarget = null;\n        this.drawObjects();\n    }\n    getPickingTarget() {\n        let target = null;\n        if (this.pickingTarget) {\n            if (Math.abs(this.pickingTarget.ex - this.pickingTarget.sx) + Math.abs(this.pickingTarget.ey - this.pickingTarget.sy) > 20) {\n                const start = this.ctxDisplayer.screenToPixel(this.pickingTarget.sx, this.pickingTarget.sy);\n                const end = this.ctxDisplayer.screenToPixel(this.pickingTarget.ex, this.pickingTarget.ey);\n                const angle = Math.atan2(start.y - end.y, end.x - start.x);\n                target = {\n                    position: {\n                        x: start.x * this.resolution,\n                        y: -start.y * this.resolution,\n                        z: 0,\n                    }, orientation: {\n                        x: 0,\n                        y: 0,\n                        z: Math.sin(angle / 2),\n                        w: Math.cos(angle / 2),\n                    }\n                };\n            }\n        }\n        this.pickingTarget = null;\n        this.drawObjects();\n        return target;\n    }\n    drawObjects() {\n        if (this.hasObjects) {\n            this.ctxDecorator.clearRect(0, 0, this.canvasDecorator.width, this.canvasDecorator.height);\n            this.ctxDecorator.drawImage(this.canvasGridCopy, 0, 0);\n        }\n        this.hasObjects = true;\n        if (this.pickingTarget) {\n            this.drawPickingTarget(this.pickingTarget, this.pickingTargetColor, '', 100 * this.pixelRatio, 10 * this.pixelRatio);\n        }\n        if (this.targetList.length) {\n            const mapAngle = this.ctxDisplayer.getAngle();\n            this.targetList.forEach((target, index) => {\n                const startOnMap = { x: target.position.x / this.resolution, y: -target.position.y / this.resolution };\n                const angle = Math.asin(target.orientation.z) * 2 - mapAngle;\n                const start = this.ctxDisplayer.pixelToScreen(startOnMap.x, startOnMap.y);\n                const end = { x: start.x + Math.cos(angle) * 32 * this.pixelRatio, y: start.y - Math.sin(angle) * 32 * this.pixelRatio };\n                const targetColor = this.targetIndex == index ? this.currentTargetColor : (this.targetIndex > index ? this.pastTargetColor : this.futureTargetColor);\n                this.drawPickingTarget({\n                    sx: start.x,\n                    sy: start.y,\n                    ex: end.x,\n                    ey: end.y,\n                }, targetColor, index.toString(), 100 * this.pixelRatio, 10 * this.pixelRatio);\n            });\n        }\n        this.drawRobotPosition();\n    }\n    drawRobotPosition() {\n        if (this.robotPosition) {\n            const mapAngle = this.ctxDisplayer.getAngle();\n            const startOnMap = { x: this.robotPosition.position.x / this.resolution, y: -this.robotPosition.position.y / this.resolution };\n            const angle = Math.asin(this.robotPosition.orientation.z) * 2 * Math.sign(this.robotPosition.orientation.w) - mapAngle;\n            console.log(angle, this.robotPosition.orientation);\n            const center = this.ctxDisplayer.pixelToScreen(startOnMap.x, startOnMap.y);\n            const tip = { x: center.x + Math.cos(angle) * 12 * this.pixelRatio, y: center.y - Math.sin(angle) * 12 * this.pixelRatio };\n            const tail = { x: center.x - Math.cos(angle) * 4 * this.pixelRatio, y: center.y + Math.sin(angle) * 4 * this.pixelRatio };\n            const arrowLength = 24 * this.pixelRatio;\n            const ctx = this.ctxDecorator;\n            ctx.fillStyle = this.robotColor;\n            ctx.strokeStyle = this.robotColor;\n            ctx.lineWidth = 2 * this.pixelRatio;\n            ctx.beginPath();\n            ctx.moveTo(tail.x, tail.y);\n            ctx.lineTo(tip.x - arrowLength * Math.cos(-angle - Math.PI / 10), tip.y - arrowLength * Math.sin(-angle - Math.PI / 10));\n            ctx.lineTo(tip.x, tip.y);\n            ctx.lineTo(tip.x - arrowLength * Math.cos(-angle + Math.PI / 10), tip.y - arrowLength * Math.sin(-angle + Math.PI / 10));\n            ctx.lineTo(tail.x, tail.y);\n            ctx.fill();\n            ctx.fillStyle = \"white\";\n            ctx.beginPath();\n            ctx.arc(center.x, center.y, 2 * this.pixelRatio, 0, Math.PI * 2, true);\n            ctx.fill();\n        }\n    }\n    drawPickingTarget(target, color, text, maxLength, headLength) {\n        const ctx = this.ctxDecorator;\n        const length = Math.sqrt(Math.pow((target.ex - target.sx), 2) + Math.pow((target.ey - target.sy), 2));\n        const endAjusted = { x: target.ex, y: target.ey };\n        if (length > maxLength) {\n            endAjusted.x = target.sx + (maxLength * (target.ex - target.sx)) / length;\n            endAjusted.y = target.sy + (maxLength * (target.ey - target.sy)) / length;\n        }\n        ctx.fillStyle = color;\n        ctx.strokeStyle = color;\n        ctx.lineWidth = 2 * this.pixelRatio;\n        ctx.beginPath();\n        ctx.arc(target.sx, target.sy, 2 * this.pixelRatio, 0, Math.PI * 2, true);\n        ctx.fill();\n        ctx.beginPath();\n        ctx.moveTo(target.sx, target.sy);\n        ctx.lineTo(endAjusted.x, endAjusted.y);\n        ctx.stroke();\n        const angle = Math.atan2(endAjusted.y - target.sy, endAjusted.x - target.sx);\n        ctx.beginPath();\n        ctx.lineTo(endAjusted.x - headLength * Math.cos(angle - Math.PI / 6), endAjusted.y - headLength * Math.sin(angle - Math.PI / 6));\n        ctx.moveTo(endAjusted.x, endAjusted.y);\n        ctx.lineTo(endAjusted.x - headLength * Math.cos(angle + Math.PI / 6), endAjusted.y - headLength * Math.sin(angle + Math.PI / 6));\n        ctx.lineTo(endAjusted.x - headLength * Math.cos(angle - Math.PI / 6), endAjusted.y - headLength * Math.sin(angle - Math.PI / 6));\n        ctx.fill();\n        ctx.lineWidth = 1;\n        ctx.font = \"32px sans-serif\";\n        ctx.fillText(text, target.sx - 3 * this.pixelRatio, Math.sign(endAjusted.y - target.sy) <= 0\n            ? target.sy + 16 * this.pixelRatio\n            : target.sy - 6 * this.pixelRatio);\n    }\n}\n//# sourceMappingURL=index.js.map","const NBBY = 8;\nconst MATCH_BITS = 6;\nconst MATCH_MIN = 3;\nconst OFFSET_MASK = (1 << (16 - MATCH_BITS)) - 1;\nexport default function decompress(\n  sstart: Uint8Array,\n  slen: number,\n  dstart: Uint8Array\n): number {\n  slen = slen | 0;\n\n  let src = 0,\n    dst = 0,\n    cpy = 0,\n    copymap = 0,\n    copymask = 1 << ((NBBY - 1) | 0),\n    mlen = 0,\n    offset = 0;\n  while (src < slen) {\n    if ((copymask <<= 1) === 1 << NBBY) {\n      copymask = 1;\n      copymap = sstart[src];\n      src = (src + 1) | 0;\n    }\n\n    if (copymap & copymask) {\n      mlen = ((sstart[src] >> ((NBBY - MATCH_BITS) | 0)) + MATCH_MIN) | 0;\n      offset = ((sstart[src] << NBBY) | sstart[(src + 1) | 0]) & OFFSET_MASK;\n      src = (src + 2) | 0;\n\n      cpy = (dst - offset) | 0;\n      {\n        while (mlen > 4) {\n          dstart[dst] = dstart[cpy];\n          dst = (dst + 1) | 0;\n          cpy = (cpy + 1) | 0;\n\n          dstart[dst] = dstart[cpy];\n          dst = (dst + 1) | 0;\n          cpy = (cpy + 1) | 0;\n\n          dstart[dst] = dstart[cpy];\n          dst = (dst + 1) | 0;\n          cpy = (cpy + 1) | 0;\n\n          dstart[dst] = dstart[cpy];\n          dst = (dst + 1) | 0;\n          cpy = (cpy + 1) | 0;\n\n          mlen = (mlen - 4) | 0;\n        }\n\n        while (mlen > 0) {\n          dstart[dst] = dstart[cpy];\n          dst = (dst + 1) | 0;\n          cpy = (cpy + 1) | 0;\n          mlen = (mlen - 1) | 0;\n        }\n      }\n    } else {\n      dstart[dst] = sstart[src];\n      dst = (dst + 1) | 0;\n      src = (src + 1) | 0;\n    }\n  }\n  return dst;\n}\n","\n/* eslint-disable */\nimport {\n  defineComponent,\n  onMounted,\n  watchEffect,\n  PropType,\n  resolveDynamicComponent,\n  onBeforeUnmount,\n  ref,\n  Ref\n} from \"vue\";\nimport { SlamCanvas, Target } from \"slam2D\";\nimport decompress from \"./slam_map_decompress\";\n\nexport default defineComponent({\n  name: \"Slam\",\n  props: {\n    isOnePick: Boolean,\n    isPicking: Boolean,\n    stickToRobot: Boolean,\n    robotPosition: Object as PropType<Target>,\n    wsAddress: String,\n    targets: Object as PropType<Target[]>,\n    targetIndex: Number\n  },\n  setup(props, { emit }) {\n    let slamCanvas: null | SlamCanvas = null;\n    let targetPointerEvent: null | PointerEvent = null;\n    let startPickingTimeout: null | number = null;\n    let ws: null | WebSocket = null;\n    let reconnectIntervalId: number = 0;\n    let timeframe = new Date().getTime();\n    const pinchPointerMap: Map<number, PointerEvent> = new Map();\n    let pinchTimeStamp: number = new Date().getTime();\n    let altPressed = false;\n\n    const connectServer = () => {\n      if (!props.wsAddress) return;\n      if (ws) ws.close();\n      console.log(props.wsAddress);\n      ws = new WebSocket(props.wsAddress);\n      ws.binaryType = \"arraybuffer\";\n      ws.onmessage = m => {\n        timeframe = new Date().getTime();\n        if (m.data.byteLength > 80) {\n          const resolution = new Float32Array(m.data, 8, 1)[0];\n          const uint32Array = new Uint32Array(m.data, 12, 2);\n          const width = uint32Array[0];\n          const height = uint32Array[1];\n          const float64Array = new Float64Array(m.data, 24, 7);\n          const x = float64Array[0];\n          const y = float64Array[1];\n          const srcData = new Uint8Array(m.data, 80);\n          const desData = new Uint8Array(width * height);\n          decompress(srcData, srcData.length, desData);\n          const map = new Uint32Array(\n            new Uint8ClampedArray(desData.length * 4).buffer\n          );\n          for (let i = 0; i < desData.length; i++) {\n            if (desData[i] === 200) {\n              map[i] = 0xff99bbbb;\n            } else if (desData[i] === 255) {\n              map[i] = 0xffdddddd;\n            } else if (desData[i] === 0) {\n              map[i] = 0xff000000;\n            } else {\n              map[i] = 0xffdddd00;\n            }\n          }\n          slamCanvas?.updateMap(map.buffer, width, height, resolution, x, y);\n        }\n      };\n    };\n\n    const isValidPointer = (evt: PointerEvent) => {\n      const element = evt.target as HTMLCanvasElement;\n      const size = element.getBoundingClientRect();\n      return (\n        evt.offsetX > 0 &&\n        evt.offsetX < size.width &&\n        evt.offsetY > 0 &&\n        evt.offsetY < size.height\n      );\n    };\n    const start = (evt: PointerEvent) => {\n      if (!isValidPointer(evt)) return;\n      if (!targetPointerEvent && props.isPicking) {\n        targetPointerEvent = evt;\n        startPickingTimeout = window.setTimeout(() => {\n          if (props.isPicking)\n            slamCanvas?.setPickingStart(evt.offsetX, evt.offsetY);\n          if (navigator.vibrate) {\n            navigator.vibrate(150);\n          }\n        }, 300);\n      }\n      if (!props.isPicking) {\n        const newPinchTime = new Date().getTime();\n        if (newPinchTime - pinchTimeStamp > 2000) {\n          pinchPointerMap.clear();\n          pinchTimeStamp = newPinchTime;\n        }\n        pinchPointerMap.set(evt.pointerId, evt);\n      }\n    };\n    const move = (evt: PointerEvent) => {\n      if (targetPointerEvent?.pointerId === evt.pointerId && props.isPicking) {\n        if (\n          Math.abs(targetPointerEvent.offsetX - evt.offsetX) +\n            Math.abs(targetPointerEvent.offsetY - evt.offsetY) >\n          10\n        ) {\n          if (startPickingTimeout) clearTimeout(startPickingTimeout);\n        }\n        slamCanvas?.setPickingEnd(evt.offsetX, evt.offsetY);\n        if (!isValidPointer(evt)) {\n          const target = slamCanvas?.getPickingTarget();\n          if (target) emit(\"update\", target);\n          targetPointerEvent = null;\n        }\n      }\n      if (!props.isPicking) {\n        const newPinchTime = new Date().getTime();\n        if (!isValidPointer(evt)) {\n          pinchPointerMap.delete(evt.pointerId);\n          pinchTimeStamp = newPinchTime;\n          return;\n        }\n        const keys = Array.from(pinchPointerMap.keys()).sort();\n        if (\n          keys.length === 1 &&\n          keys[0] === evt.pointerId &&\n          pinchPointerMap.has(evt.pointerId)\n        ) {\n          const cx = pinchPointerMap.get(evt.pointerId)!.offsetX;\n          const cy = pinchPointerMap.get(evt.pointerId)!.offsetY;\n          const dx = evt.offsetX - cx;\n          const dy = evt.offsetY - cy;\n          slamCanvas?.updateTransform(cx, cy, 0, 1, dx, dy);\n          pinchPointerMap.set(evt.pointerId, evt);\n          pinchTimeStamp = newPinchTime;\n        }\n        if (\n          keys.length > 1 &&\n          (evt.pointerId === keys[0] || evt.pointerId === keys[1])\n        ) {\n          const cx =\n            (pinchPointerMap.get(keys[0])!.offsetX +\n              pinchPointerMap.get(keys[1])!.offsetX) /\n            2;\n          const cy =\n            (pinchPointerMap.get(keys[0])!.offsetY +\n              pinchPointerMap.get(keys[1])!.offsetY) /\n            2;\n          const dx =\n            (evt.offsetX - pinchPointerMap.get(evt.pointerId)!.offsetX) / 2;\n          const dy =\n            (evt.offsetY - pinchPointerMap.get(evt.pointerId)!.offsetY) / 2;\n          const fixedPointer =\n            evt.pointerId === keys[0]\n              ? pinchPointerMap.get(keys[1])\n              : pinchPointerMap.get(keys[0]);\n          const vector1 = {\n            x:\n              pinchPointerMap.get(evt.pointerId)!.offsetX -\n              fixedPointer!.offsetX,\n            y:\n              pinchPointerMap.get(evt.pointerId)!.offsetY -\n              fixedPointer!.offsetY\n          };\n          const vector2 = {\n            x: evt.offsetX - fixedPointer!.offsetX,\n            y: evt.offsetY - fixedPointer!.offsetY\n          };\n          const scale = Math.sqrt(\n            (vector2.x ** 2 + vector2.y ** 2) /\n              (vector1.x ** 2 + vector1.y ** 2)\n          );\n          const radian =\n            (vector1.x * vector2.y - vector2.x * vector1.y) /\n            (vector1.x ** 2 + vector1.y ** 2);\n          slamCanvas?.updateTransform(cx, cy, radian, scale, dx, dy);\n          pinchPointerMap.set(evt.pointerId, evt);\n          pinchTimeStamp = newPinchTime;\n        }\n      }\n    };\n    const end = (evt: PointerEvent) => {\n      if (targetPointerEvent?.pointerId === evt.pointerId && props.isPicking) {\n        if (startPickingTimeout) clearTimeout(startPickingTimeout);\n        slamCanvas?.setPickingEnd(evt.offsetX, evt.offsetY);\n        const target = slamCanvas?.getPickingTarget();\n        if (target) {\n          emit(\"update\", target);\n        }\n      }\n      targetPointerEvent = null;\n      pinchPointerMap.delete(evt.pointerId);\n      pinchTimeStamp = new Date().getTime();\n    };\n\n    const wheel = (evt: MouseWheelEvent) => {\n      if (!props.isPicking) {\n        if (!altPressed) {\n          slamCanvas?.updateTransform(\n            evt.offsetX,\n            evt.offsetY,\n            0,\n            1.001 ** evt.deltaY,\n            0,\n            0\n          );\n        } else {\n          slamCanvas?.updateTransform(\n            evt.offsetX,\n            evt.offsetY,\n            evt.deltaY/1000,\n            1,\n            0,\n            0\n          );\n        }\n      }\n    };\n\n    const altListener = (evt: KeyboardEvent) => {\n      if (evt.key === \"Alt\") {\n        if (evt.type === \"keydown\") altPressed = true;\n        if (evt.type === \"keyup\") altPressed = false;\n      }\n    };\n\n    watchEffect(() => {\n      if (!props.isPicking) {\n        slamCanvas?.cancelPickingTarget();\n        targetPointerEvent = null;\n      }\n      pinchPointerMap.clear();\n    });\n\n    //..................\n    watchEffect(() => {\n      if (props.robotPosition) {\n        slamCanvas?.updateRobotPosition(props.robotPosition);\n      }\n    });\n    watchEffect(() => {\n      if (props.targets) {\n        slamCanvas?.updateTargets(props.targets);\n      }\n    });\n    watchEffect(() => {\n      if (props.targetIndex !== undefined) {\n        slamCanvas?.updateTargetIndex(props.targetIndex);\n      }\n    });\n    watchEffect(() => {\n      const config = { stickToRobot: props.stickToRobot && !props.isPicking };\n      slamCanvas?.setConfig(config);\n      if (props.isPicking && props.stickToRobot) {\n        slamCanvas?.moveToRobot();\n      }\n    });\n\n    //...............\n\n    onMounted(() => {\n      slamCanvas = new SlamCanvas(\"slamDisplayer\", \"slamDecorator\");\n      slamCanvas.setConfig({\n        currentTargetColor:\"orange\",\n        pickingTargetColor: \"blue\",\n        gridSize: 1,\n        pastTargetColor: \"red\"\n      });\n      connectServer();\n      reconnectIntervalId = window.setInterval(() => {\n        const now = new Date().getTime();\n        if (now - timeframe > 5000) {\n          timeframe = now;\n          connectServer();\n        }\n      }, 500);\n      window.addEventListener(\"keydown\", altListener);\n      window.addEventListener(\"keyup\", altListener);\n    });\n    onBeforeUnmount(() => {\n      if (ws) ws.close();\n      window.clearInterval(reconnectIntervalId);\n      window.removeEventListener(\"keydown\", altListener);\n      window.removeEventListener(\"keyup\", altListener);\n    });\n    return { start, move, end, wheel };\n  }\n});\n","import { render } from \"./SlamMap.vue?vue&type=template&id=6eef317a&scoped=true\"\nimport script from \"./SlamMap.vue?vue&type=script&lang=ts\"\nexport * from \"./SlamMap.vue?vue&type=script&lang=ts\"\n\nimport \"./SlamMap.vue?vue&type=style&index=0&id=6eef317a&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-6eef317a\"\n\nexport default script","\nimport { defineComponent, ref, onMounted, Ref, onBeforeUnmount } from \"vue\";\nimport SlamMap from \"@/components/SlamMap.vue\";\nimport { Target } from \"slam2D\";\nimport MqttPlugin from \"@/plugins/mqttPlugin\";\nimport I18nPlugin from \"@/plugins/i18nPlugin\";\nexport default defineComponent({\n  name: \"Slam\",\n  components: {\n    SlamMap\n  },\n  setup() {\n    const i18n = I18nPlugin.use();\n    const mqtt = MqttPlugin.use();\n    const isPicking = ref(false);\n    const robotPosition: Ref<Target | null> = ref(null);\n    const followingRobot = ref(false);\n    const mapAddress = ref(\n      process.env.NODE_ENV == \"development\"\n        ? process.env.VUE_APP_DEVICE_ADDRESS\n        : window.location.host\n    );\n\n    onMounted(() => {\n      setTimeout(() => {\n        mqtt.subscribe(\"slam/position\", { qos: 0 });\n        mqtt.subscribe([\"slam/targets\", \"slam/target_index\", \"slam/looping\"], {\n          qos: 1\n        });\n      }, 1000);\n    });\n\n    onBeforeUnmount(() => {\n      mqtt.unsubscribe([\n        \"slam/position\",\n        \"slam/targets\",\n        \"slam/target_index\",\n        \"slam/looping\"\n      ]);\n    });\n    const handleTarget = (target: Target) => {\n      const floats = new Float64Array(7);\n      floats[0] = target.position.x;\n      floats[1] = target.position.y;\n      floats[2] = target.position.z;\n      floats[3] = target.orientation.x;\n      floats[4] = target.orientation.y;\n      floats[5] = target.orientation.z;\n      floats[6] = target.orientation.w;\n      mqtt.publish(\"slam/new_target\", floats.buffer, { qos: 0 });\n    };\n    const handleFollowing = () => {\n      followingRobot.value = !followingRobot.value;\n      if (isPicking.value && followingRobot.value) {\n        setTimeout(() => {\n          followingRobot.value = false;\n        }, 500);\n      }\n    };\n    const sendAction = (action: string) => {\n      mqtt.publish(\"slam/action\", action, { qos: 1 });\n    };\n    const sendSLAMsh = (sh: string) => {\n      mqtt.publish(\"slam/manager\", sh, { qos: 1 });\n    };\n    return {\n      isPicking,\n      robotPosition,\n      mqtt,\n      handleTarget,\n      handleFollowing,\n      sendAction,\n      sendSLAMsh,\n      followingRobot,\n      i18n,\n      mapAddress\n    };\n  }\n});\n","import { render } from \"./Slam.vue?vue&type=template&id=4b9c5e29&scoped=true\"\nimport script from \"./Slam.vue?vue&type=script&lang=ts\"\nexport * from \"./Slam.vue?vue&type=script&lang=ts\"\n\nimport \"./Slam.vue?vue&type=style&index=0&id=4b9c5e29&lang=scss&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-4b9c5e29\"\n\nexport default script","// a string of all valid unicode whitespaces\n// eslint-disable-next-line max-len\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","var requireObjectCoercible = require('../internals/require-object-coercible');\nvar whitespaces = require('../internals/whitespaces');\n\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = String(requireObjectCoercible($this));\n    if (TYPE & 1) string = string.replace(ltrim, '');\n    if (TYPE & 2) string = string.replace(rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./SlamMap.vue?vue&type=style&index=0&id=6eef317a&lang=scss&scoped=true\"","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","'use strict';\nvar defineProperty = require('../internals/object-define-property').f;\nvar create = require('../internals/object-create');\nvar redefineAll = require('../internals/redefine-all');\nvar bind = require('../internals/function-bind-context');\nvar anInstance = require('../internals/an-instance');\nvar iterate = require('../internals/iterate');\nvar defineIterator = require('../internals/define-iterator');\nvar setSpecies = require('../internals/set-species');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar fastKey = require('../internals/internal-metadata').fastKey;\nvar InternalStateModule = require('../internals/internal-state');\n\nvar setInternalState = InternalStateModule.set;\nvar internalStateGetterFor = InternalStateModule.getterFor;\n\nmodule.exports = {\n  getConstructor: function (wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER) {\n    var C = wrapper(function (that, iterable) {\n      anInstance(that, C, CONSTRUCTOR_NAME);\n      setInternalState(that, {\n        type: CONSTRUCTOR_NAME,\n        index: create(null),\n        first: undefined,\n        last: undefined,\n        size: 0\n      });\n      if (!DESCRIPTORS) that.size = 0;\n      if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n    });\n\n    var getInternalState = internalStateGetterFor(CONSTRUCTOR_NAME);\n\n    var define = function (that, key, value) {\n      var state = getInternalState(that);\n      var entry = getEntry(that, key);\n      var previous, index;\n      // change existing entry\n      if (entry) {\n        entry.value = value;\n      // create new entry\n      } else {\n        state.last = entry = {\n          index: index = fastKey(key, true),\n          key: key,\n          value: value,\n          previous: previous = state.last,\n          next: undefined,\n          removed: false\n        };\n        if (!state.first) state.first = entry;\n        if (previous) previous.next = entry;\n        if (DESCRIPTORS) state.size++;\n        else that.size++;\n        // add to index\n        if (index !== 'F') state.index[index] = entry;\n      } return that;\n    };\n\n    var getEntry = function (that, key) {\n      var state = getInternalState(that);\n      // fast case\n      var index = fastKey(key);\n      var entry;\n      if (index !== 'F') return state.index[index];\n      // frozen object case\n      for (entry = state.first; entry; entry = entry.next) {\n        if (entry.key == key) return entry;\n      }\n    };\n\n    redefineAll(C.prototype, {\n      // 23.1.3.1 Map.prototype.clear()\n      // 23.2.3.2 Set.prototype.clear()\n      clear: function clear() {\n        var that = this;\n        var state = getInternalState(that);\n        var data = state.index;\n        var entry = state.first;\n        while (entry) {\n          entry.removed = true;\n          if (entry.previous) entry.previous = entry.previous.next = undefined;\n          delete data[entry.index];\n          entry = entry.next;\n        }\n        state.first = state.last = undefined;\n        if (DESCRIPTORS) state.size = 0;\n        else that.size = 0;\n      },\n      // 23.1.3.3 Map.prototype.delete(key)\n      // 23.2.3.4 Set.prototype.delete(value)\n      'delete': function (key) {\n        var that = this;\n        var state = getInternalState(that);\n        var entry = getEntry(that, key);\n        if (entry) {\n          var next = entry.next;\n          var prev = entry.previous;\n          delete state.index[entry.index];\n          entry.removed = true;\n          if (prev) prev.next = next;\n          if (next) next.previous = prev;\n          if (state.first == entry) state.first = next;\n          if (state.last == entry) state.last = prev;\n          if (DESCRIPTORS) state.size--;\n          else that.size--;\n        } return !!entry;\n      },\n      // 23.2.3.6 Set.prototype.forEach(callbackfn, thisArg = undefined)\n      // 23.1.3.5 Map.prototype.forEach(callbackfn, thisArg = undefined)\n      forEach: function forEach(callbackfn /* , that = undefined */) {\n        var state = getInternalState(this);\n        var boundFunction = bind(callbackfn, arguments.length > 1 ? arguments[1] : undefined, 3);\n        var entry;\n        while (entry = entry ? entry.next : state.first) {\n          boundFunction(entry.value, entry.key, this);\n          // revert to the last existing entry\n          while (entry && entry.removed) entry = entry.previous;\n        }\n      },\n      // 23.1.3.7 Map.prototype.has(key)\n      // 23.2.3.7 Set.prototype.has(value)\n      has: function has(key) {\n        return !!getEntry(this, key);\n      }\n    });\n\n    redefineAll(C.prototype, IS_MAP ? {\n      // 23.1.3.6 Map.prototype.get(key)\n      get: function get(key) {\n        var entry = getEntry(this, key);\n        return entry && entry.value;\n      },\n      // 23.1.3.9 Map.prototype.set(key, value)\n      set: function set(key, value) {\n        return define(this, key === 0 ? 0 : key, value);\n      }\n    } : {\n      // 23.2.3.1 Set.prototype.add(value)\n      add: function add(value) {\n        return define(this, value = value === 0 ? 0 : value, value);\n      }\n    });\n    if (DESCRIPTORS) defineProperty(C.prototype, 'size', {\n      get: function () {\n        return getInternalState(this).size;\n      }\n    });\n    return C;\n  },\n  setStrong: function (C, CONSTRUCTOR_NAME, IS_MAP) {\n    var ITERATOR_NAME = CONSTRUCTOR_NAME + ' Iterator';\n    var getInternalCollectionState = internalStateGetterFor(CONSTRUCTOR_NAME);\n    var getInternalIteratorState = internalStateGetterFor(ITERATOR_NAME);\n    // add .keys, .values, .entries, [@@iterator]\n    // 23.1.3.4, 23.1.3.8, 23.1.3.11, 23.1.3.12, 23.2.3.5, 23.2.3.8, 23.2.3.10, 23.2.3.11\n    defineIterator(C, CONSTRUCTOR_NAME, function (iterated, kind) {\n      setInternalState(this, {\n        type: ITERATOR_NAME,\n        target: iterated,\n        state: getInternalCollectionState(iterated),\n        kind: kind,\n        last: undefined\n      });\n    }, function () {\n      var state = getInternalIteratorState(this);\n      var kind = state.kind;\n      var entry = state.last;\n      // revert to the last existing entry\n      while (entry && entry.removed) entry = entry.previous;\n      // get next entry\n      if (!state.target || !(state.last = entry = entry ? entry.next : state.state.first)) {\n        // or finish the iteration\n        state.target = undefined;\n        return { value: undefined, done: true };\n      }\n      // return step by kind\n      if (kind == 'keys') return { value: entry.key, done: false };\n      if (kind == 'values') return { value: entry.value, done: false };\n      return { value: [entry.key, entry.value], done: false };\n    }, IS_MAP ? 'entries' : 'values', !IS_MAP, true);\n\n    // add [@@species], 23.1.2.2, 23.2.2.2\n    setSpecies(CONSTRUCTOR_NAME);\n  }\n};\n","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar InternalMetadataModule = require('../internals/internal-metadata');\nvar iterate = require('../internals/iterate');\nvar anInstance = require('../internals/an-instance');\nvar isObject = require('../internals/is-object');\nvar fails = require('../internals/fails');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar inheritIfRequired = require('../internals/inherit-if-required');\n\nmodule.exports = function (CONSTRUCTOR_NAME, wrapper, common) {\n  var IS_MAP = CONSTRUCTOR_NAME.indexOf('Map') !== -1;\n  var IS_WEAK = CONSTRUCTOR_NAME.indexOf('Weak') !== -1;\n  var ADDER = IS_MAP ? 'set' : 'add';\n  var NativeConstructor = global[CONSTRUCTOR_NAME];\n  var NativePrototype = NativeConstructor && NativeConstructor.prototype;\n  var Constructor = NativeConstructor;\n  var exported = {};\n\n  var fixMethod = function (KEY) {\n    var nativeMethod = NativePrototype[KEY];\n    redefine(NativePrototype, KEY,\n      KEY == 'add' ? function add(value) {\n        nativeMethod.call(this, value === 0 ? 0 : value);\n        return this;\n      } : KEY == 'delete' ? function (key) {\n        return IS_WEAK && !isObject(key) ? false : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : KEY == 'get' ? function get(key) {\n        return IS_WEAK && !isObject(key) ? undefined : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : KEY == 'has' ? function has(key) {\n        return IS_WEAK && !isObject(key) ? false : nativeMethod.call(this, key === 0 ? 0 : key);\n      } : function set(key, value) {\n        nativeMethod.call(this, key === 0 ? 0 : key, value);\n        return this;\n      }\n    );\n  };\n\n  // eslint-disable-next-line max-len\n  if (isForced(CONSTRUCTOR_NAME, typeof NativeConstructor != 'function' || !(IS_WEAK || NativePrototype.forEach && !fails(function () {\n    new NativeConstructor().entries().next();\n  })))) {\n    // create collection constructor\n    Constructor = common.getConstructor(wrapper, CONSTRUCTOR_NAME, IS_MAP, ADDER);\n    InternalMetadataModule.REQUIRED = true;\n  } else if (isForced(CONSTRUCTOR_NAME, true)) {\n    var instance = new Constructor();\n    // early implementations not supports chaining\n    var HASNT_CHAINING = instance[ADDER](IS_WEAK ? {} : -0, 1) != instance;\n    // V8 ~ Chromium 40- weak-collections throws on primitives, but should return false\n    var THROWS_ON_PRIMITIVES = fails(function () { instance.has(1); });\n    // most early implementations doesn't supports iterables, most modern - not close it correctly\n    // eslint-disable-next-line no-new\n    var ACCEPT_ITERABLES = checkCorrectnessOfIteration(function (iterable) { new NativeConstructor(iterable); });\n    // for early implementations -0 and +0 not the same\n    var BUGGY_ZERO = !IS_WEAK && fails(function () {\n      // V8 ~ Chromium 42- fails only with 5+ elements\n      var $instance = new NativeConstructor();\n      var index = 5;\n      while (index--) $instance[ADDER](index, index);\n      return !$instance.has(-0);\n    });\n\n    if (!ACCEPT_ITERABLES) {\n      Constructor = wrapper(function (dummy, iterable) {\n        anInstance(dummy, Constructor, CONSTRUCTOR_NAME);\n        var that = inheritIfRequired(new NativeConstructor(), dummy, Constructor);\n        if (iterable != undefined) iterate(iterable, that[ADDER], { that: that, AS_ENTRIES: IS_MAP });\n        return that;\n      });\n      Constructor.prototype = NativePrototype;\n      NativePrototype.constructor = Constructor;\n    }\n\n    if (THROWS_ON_PRIMITIVES || BUGGY_ZERO) {\n      fixMethod('delete');\n      fixMethod('has');\n      IS_MAP && fixMethod('get');\n    }\n\n    if (BUGGY_ZERO || HASNT_CHAINING) fixMethod(ADDER);\n\n    // weak collections should not contains .clear method\n    if (IS_WEAK && NativePrototype.clear) delete NativePrototype.clear;\n  }\n\n  exported[CONSTRUCTOR_NAME] = Constructor;\n  $({ global: true, forced: Constructor != NativeConstructor }, exported);\n\n  setToStringTag(Constructor, CONSTRUCTOR_NAME);\n\n  if (!IS_WEAK) common.setStrong(Constructor, CONSTRUCTOR_NAME, IS_MAP);\n\n  return Constructor;\n};\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint8ClampedArray` constructor\n// https://tc39.github.io/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint8', function (init) {\n  return function Uint8ClampedArray(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n}, true);\n","var anObject = require('../internals/an-object');\nvar iteratorClose = require('../internals/iterator-close');\n\n// call something on iterator step with safe closing on error\nmodule.exports = function (iterator, fn, value, ENTRIES) {\n  try {\n    return ENTRIES ? fn(anObject(value)[0], value[1]) : fn(value);\n  // 7.4.6 IteratorClose(iterator, completion)\n  } catch (error) {\n    iteratorClose(iterator);\n    throw error;\n  }\n};\n","var $ = require('../internals/export');\nvar from = require('../internals/array-from');\nvar checkCorrectnessOfIteration = require('../internals/check-correctness-of-iteration');\n\nvar INCORRECT_ITERATION = !checkCorrectnessOfIteration(function (iterable) {\n  Array.from(iterable);\n});\n\n// `Array.from` method\n// https://tc39.github.io/ecma262/#sec-array.from\n$({ target: 'Array', stat: true, forced: INCORRECT_ITERATION }, {\n  from: from\n});\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar has = require('../internals/has');\nvar classof = require('../internals/classof-raw');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar toPrimitive = require('../internals/to-primitive');\nvar fails = require('../internals/fails');\nvar create = require('../internals/object-create');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar trim = require('../internals/string-trim').trim;\n\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\n\n// Opera ~12 has broken Object#toString\nvar BROKEN_CLASSOF = classof(create(NumberPrototype)) == NUMBER;\n\n// `ToNumber` abstract operation\n// https://tc39.github.io/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  var first, third, radix, maxCode, digits, length, index, code;\n  if (typeof it == 'string' && it.length > 2) {\n    it = trim(it);\n    first = it.charCodeAt(0);\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = it.slice(2);\n      length = digits.length;\n      for (index = 0; index < length; index++) {\n        code = digits.charCodeAt(index);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.github.io/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var dummy = this;\n    return dummy instanceof NumberWrapper\n      // check on 1..constructor(foo) case\n      && (BROKEN_CLASSOF ? fails(function () { NumberPrototype.valueOf.call(dummy); }) : classof(dummy) != NUMBER)\n        ? inheritIfRequired(new NativeNumber(toNumber(it)), dummy, NumberWrapper) : toNumber(it);\n  };\n  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,' +\n    // ESNext\n    'fromString,range'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(NativeNumber, key = keys[j]) && !has(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  redefine(global, NUMBER, NumberWrapper);\n}\n","var fails = require('../internals/fails');\n\nmodule.exports = !fails(function () {\n  return Object.isExtensible(Object.preventExtensions({}));\n});\n","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nexport default function _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Float32Array` constructor\n// https://tc39.github.io/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Float32', function (init) {\n  return function Float32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n","export default function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar ArrayIteratorMethods = require('../modules/es.array.iterator');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar ArrayValues = ArrayIteratorMethods.values;\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  if (CollectionPrototype) {\n    // some Chrome versions have non-configurable methods on DOMTokenList\n    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {\n      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);\n    } catch (error) {\n      CollectionPrototype[ITERATOR] = ArrayValues;\n    }\n    if (!CollectionPrototype[TO_STRING_TAG]) {\n      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n    }\n    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {\n      // some Chrome versions have non-configurable methods on DOMTokenList\n      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {\n        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);\n      } catch (error) {\n        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];\n      }\n    }\n  }\n}\n","var hiddenKeys = require('../internals/hidden-keys');\nvar isObject = require('../internals/is-object');\nvar has = require('../internals/has');\nvar defineProperty = require('../internals/object-define-property').f;\nvar uid = require('../internals/uid');\nvar FREEZING = require('../internals/freezing');\n\nvar METADATA = uid('meta');\nvar id = 0;\n\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\n\nvar setMetadata = function (it) {\n  defineProperty(it, METADATA, { value: {\n    objectID: 'O' + ++id, // object ID\n    weakData: {}          // weak collections IDs\n  } });\n};\n\nvar fastKey = function (it, create) {\n  // return a primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMetadata(it);\n  // return object ID\n  } return it[METADATA].objectID;\n};\n\nvar getWeakData = function (it, create) {\n  if (!has(it, METADATA)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMetadata(it);\n  // return the store of weak collections IDs\n  } return it[METADATA].weakData;\n};\n\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZING && meta.REQUIRED && isExtensible(it) && !has(it, METADATA)) setMetadata(it);\n  return it;\n};\n\nvar meta = module.exports = {\n  REQUIRED: false,\n  fastKey: fastKey,\n  getWeakData: getWeakData,\n  onFreeze: onFreeze\n};\n\nhiddenKeys[METADATA] = true;\n","// `Math.sign` method implementation\n// https://tc39.github.io/ecma262/#sec-math.sign\nmodule.exports = Math.sign || function sign(x) {\n  // eslint-disable-next-line no-self-compare\n  return (x = +x) == 0 || x != x ? x : x < 0 ? -1 : 1;\n};\n","var createTypedArrayConstructor = require('../internals/typed-array-constructor');\n\n// `Uint32Array` constructor\n// https://tc39.github.io/ecma262/#sec-typedarray-objects\ncreateTypedArrayConstructor('Uint32', function (init) {\n  return function Uint32Array(data, byteOffset, length) {\n    return init(this, data, byteOffset, length);\n  };\n});\n"],"sourceRoot":""}